<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>P5.js Endless Game</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      overflow: hidden;
      background-color: #f0f0f0;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
<script>
  let player;
  let score = 0;
  let highScore = 0;
  let trainImage;
  let clickedMessage = "";
  let showChoices = false;
  let gamePrompt = "Stare onward and look at that view, take it all in and stare further into the distance, onto the other side of the horizonâ€”yeah, right over there. Do you see it? The emergency brake of that metro car has been tampered with beyond function and it is derailing as we are forced to catch its spectacle. Here, you could stay in the viscid; there, you plummet into chaos.";

  function preload() {
    // Load the train image
    trainImage = loadImage('train1.png');
  }

  function setup() {
    // Create a 1000x1000 canvas and center it
    let cnv = createCanvas(1000, 1000);
    cnv.position((windowWidth - width) / 2, (windowHeight - height) / 2);
    player = new Player();
  }

  function draw() {
    // Set the background image
    background(trainImage);
    
    // Display player
    player.update();
    player.show();
    
    // Display game information
    displayCoordinates();
    checkInteractiveZones();

    fill(0);
    textSize(32);
    text("Score: " + score, 20, 40);
    text("High Score: " + highScore + " - How many times have you saved this train?", 20, 80);

    fill(50);
    textSize(20);
    textAlign(LEFT, TOP);
    text(gamePrompt, 20, 120, 960);
  }

  function displayCoordinates() {
    fill(0);
    textSize(16);
    text("x: " + mouseX + " y: " + mouseY, 20, height - 20);
  }

  function checkInteractiveZones() {
    // Define interaction zones for different elements in the image
    let trainZone = { x: 100, y: 850, w: 800, h: 100 }; // Train at the bottom
    let tracksZone = { x: 0, y: 900, w: 1000, h: 100 }; // Tracks below the train
    let cloudZones = [
      { x: 100, y: 100, w: 200, h: 100 }, // Left cloud
      { x: 400, y: 50, w: 200, h: 100 },  // Middle cloud
      { x: 750, y: 150, w: 200, h: 100 }  // Right cloud
    ];
    let skylineZone = { x: 300, y: 400, w: 400, h: 200 }; // Skyline on the horizon

    // Check for mouseover and change cursor accordingly
    if (mouseX > trainZone.x && mouseX < trainZone.x + trainZone.w && mouseY > trainZone.y && mouseY < trainZone.y + trainZone.h) {
      cursor('pointer');
    } else if (mouseX > tracksZone.x && mouseX < tracksZone.x + tracksZone.w && mouseY > tracksZone.y && mouseY < tracksZone.y + tracksZone.h) {
      cursor('pointer');
    } else if (cloudZones.some(zone => mouseX > zone.x && mouseX < zone.x + zone.w && mouseY > zone.y && mouseY < zone.y + zone.h)) {
      cursor('pointer');
    } else if (mouseX > skylineZone.x && mouseX < skylineZone.x + skylineZone.w && mouseY > skylineZone.y && mouseY < skylineZone.y + skylineZone.h) {
      cursor('pointer');
    } else {
      cursor('default');
    }
  }

  function mousePressed() {
    // Define interaction zones for different elements in the image
    let trainZone = { x: 100, y: 850, w: 800, h: 100 }; // Train at the bottom
    let tracksZone = { x: 0, y: 900, w: 1000, h: 100 }; // Tracks below the train
    let cloudZones = [
      { x: 100, y: 100, w: 200, h: 100 }, // Left cloud
      { x: 400, y: 50, w: 200, h: 100 },  // Middle cloud
      { x: 750, y: 150, w: 200, h: 100 }  // Right cloud
    ];
    let skylineZone = { x: 300, y: 400, w: 400, h: 200 }; // Skyline on the horizon

    // Check if train zone is clicked
    if (mouseX > trainZone.x && mouseX < trainZone.x + trainZone.w && mouseY > trainZone.y && mouseY < trainZone.y + trainZone.h) {
      clickedMessage = "You clicked on the train!";
      highScore++;
      resetGame();
    }
    // Check if tracks zone is clicked
    else if (mouseX > tracksZone.x && mouseX < tracksZone.x + tracksZone.w && mouseY > tracksZone.y && mouseY < tracksZone.y + tracksZone.h) {
      clickedMessage = "You clicked on the tracks!";
      resetGame();
    }
    // Check if any cloud zone is clicked
    else if (cloudZones.some(zone => mouseX > zone.x && mouseX < zone.x + zone.w && mouseY > zone.y && mouseY < zone.y + zone.h)) {
      clickedMessage = "You clicked on a cloud!";
      resetGame();
    }
    // Check if skyline zone is clicked
    else if (mouseX > skylineZone.x && mouseX < skylineZone.x + skylineZone.w && mouseY > skylineZone.y && mouseY < skylineZone.y + skylineZone.h) {
      clickedMessage = "You clicked on the skyline!";
      resetGame();
    }
  }

  function resetGame() {
    // Reset game variables
    score = 0;
    showChoices = false;
    clickedMessage = "";
    player = new Player();
    loop();
  }

  class Player {
    constructor() {
      this.x = width / 2;
      this.y = height / 2;
      this.size = 50;
      this.speed = 5;
    }

    update() {
      if (keyIsDown(LEFT_ARROW)) {
        this.x -= this.speed;
      }
      if (keyIsDown(RIGHT_ARROW)) {
        this.x += this.speed;
      }
      if (keyIsDown(UP_ARROW)) {
        this.y -= this.speed;
      }
      if (keyIsDown(DOWN_ARROW)) {
        this.y += this.speed;
      }

      this.x = constrain(this.x, 0, width - this.size);
      this.y = constrain(this.y, 0, height - this.size);
    }

    show() {
      fill(50, 100, 200);
      noStroke();
      rect(this.x, this.y, this.size, this.size);
    }
  }

  function windowResized() {
    resizeCanvas(1000, 1000);
    let cnv = createCanvas(1000, 1000);
    cnv.position((windowWidth - width) / 2, (windowHeight - height) / 2);
  }
</script>
</body>
</html>
